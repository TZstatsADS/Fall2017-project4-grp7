"""
This is used to generate the prediction matrix

"""

import numpy as np
import pandas as pd



def mixture_model_prediction(A,THETA):
    """
    return the prediction matrix
    A and THETA generated by cluster_model.py should also be pandas matrix 
    """
    m=A.shape[0] # number of users
    n=THETA[0].shape[0] # number of items
    #print n
    prob_0=[]
    
    for k in range(len(THETA)): # theta is a matrix for every cluster
        prob_0.append(A[:,k].reshape(m,1).dot(THETA[k][:,0].reshape(1,n)))
    probability_matrix_0=np.sum(prob_0,0)
    probability_matrix_1=1-probability_matrix_0
    #print probability_matrix_0
    
    prediction_matrix=np.zeros([m,n])
    prediction_matrix[probability_matrix_0<0.5]=1
    
    #print prediction_matrix
    return prediction_matrix    


